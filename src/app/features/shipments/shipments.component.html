<div class="container mx-auto">
    <div class="flex justify-between items-center mb-6">
        <h1 class="text-3xl font-bold text-primary-dark">Shipments</h1>
        <button (click)="showCreateForm = !showCreateForm"
            class="bg-primary text-white px-4 py-2 rounded-lg hover:bg-primary-dark">
            {{ showCreateForm ? 'Cancel' : '+ New Shipment' }}
        </button>
    </div>

    <!-- Create Form -->
    <div *ngIf="showCreateForm" class="bg-white rounded-lg shadow p-6 mb-6">
        <h2 class="text-xl font-bold mb-4">Create New Shipment</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
                <label class="block text-sm font-medium mb-1">Origin</label>
                <input type="text" [(ngModel)]="newShipment.origin" class="w-full px-3 py-2 border rounded-lg" />
            </div>
            <div>
                <label class="block text-sm font-medium mb-1">Destination</label>
                <input type="text" [(ngModel)]="newShipment.destination" class="w-full px-3 py-2 border rounded-lg" />
            </div>
            <div>
                <label class="block text-sm font-medium mb-1">Produce Type</label>
                <input type="text" [(ngModel)]="newShipment.produceType" class="w-full px-3 py-2 border rounded-lg" />
            </div>
            <div>
                <label class="block text-sm font-medium mb-1">Weight</label>
                <input type="number" [(ngModel)]="newShipment.weight" class="w-full px-3 py-2 border rounded-lg" />
            </div>
            <div class="md:col-span-2">
                <label class="block text-sm font-medium mb-1">Description</label>
                <textarea [(ngModel)]="newShipment.description" class="w-full px-3 py-2 border rounded-lg"
                    rows="2"></textarea>
            </div>
            <div>
                <label class="block text-sm font-medium mb-1">Estimated Delivery</label>
                <input type="date" [(ngModel)]="newShipment.estimatedDelivery"
                    class="w-full px-3 py-2 border rounded-lg" />
            </div>
        </div>
        <button (click)="createShipment()"
            class="mt-4 bg-primary text-white px-6 py-2 rounded-lg hover:bg-primary-dark">
            Create Shipment
        </button>
    </div>

    <!-- Filters -->
    <div class="bg-white rounded-lg shadow p-4 mb-6">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
                <input type="text" [(ngModel)]="searchTerm" (ngModelChange)="onSearchChange()"
                    placeholder="Search by origin, destination, or produce..."
                    class="w-full px-4 py-2 border rounded-lg" />
            </div>
            <div>
                <select [(ngModel)]="selectedStatus" (ngModelChange)="onStatusFilterChange()"
                    class="w-full px-4 py-2 border rounded-lg">
                    <option value="">All Statuses</option>
                    <option value="PENDING">Pending</option>
                    <option value="IN_TRANSIT">In Transit</option>
                    <option value="DELIVERED">Delivered</option>
                </select>
            </div>
        </div>
    </div>

    <!-- Shipments List -->
    <app-loading-spinner *ngIf="loading" [fullScreen]="false"></app-loading-spinner>

    <div *ngIf="!loading" class="bg-white rounded-lg shadow overflow-hidden">
        <div class="overflow-x-auto">
            <table class="w-full">
                <thead class="bg-gray-50">
                    <tr>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">ID</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Origin</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Destination</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Produce</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Weight</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase">Status</th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-gray-200">
                    <tr *ngFor="let shipment of filteredShipments" class="hover:bg-gray-50">
                        <td class="px-6 py-4 text-sm">{{ shipment.id }}</td>
                        <td class="px-6 py-4 text-sm">{{ shipment.origin }}</td>
                        <td class="px-6 py-4 text-sm">{{ shipment.destination }}</td>
                        <td class="px-6 py-4 text-sm">{{ shipment.produceType }}</td>
                        <td class="px-6 py-4 text-sm">{{ shipment.weight }}</td>
                        <td class="px-6 py-4">
                            <app-status-badge [status]="shipment.status"></app-status-badge>
                        </td>
                    </tr>
                    <tr *ngIf="filteredShipments.length === 0">
                        <td colspan="7" class="px-6 py-8 text-center text-gray-500">No shipments found</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>